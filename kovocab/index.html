<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°œìŠˆíƒ€ì¸ ë°•ì‚¬ë‹˜ì˜ ì–´íœ˜ ì™ì™!</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Jua', sans-serif; background: #fff9c4; text-align: center; margin: 0; padding: 20px; }
        .game-box { background: white; border-radius: 20px; padding: 30px; max-width: 1200px; margin: 0 auto; box-shadow: 0 10px 25px rgba(0,0,0,0.1); border: 5px solid #ffca28; }
        .hidden { display: none !important; }
        
        h1 { color: #d84315; margin-bottom: 10px; word-break: keep-all; font-size: 36px; text-shadow: 2px 2px 0px #fff; }
        
        /* â˜… ìºë¦­í„° ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .character-area {
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }
        .char-img {
            width: 160px;       /* ì´ë¯¸ì§€ í¬ê¸° */
            height: 160px;
            object-fit: cover;  /* ë¹„ìœ¨ ìœ ì§€í•˜ë©° ê½‰ ì±„ìš°ê¸° */
            border-radius: 50%; /* ë™ê·¸ë—ê²Œ ë§Œë“¤ê¸° */
            border: 6px solid white; /* í°ìƒ‰ í…Œë‘ë¦¬ */
            box-shadow: 0 8px 15px rgba(0,0,0,0.2); /* ê·¸ë¦¼ì íš¨ê³¼ */
            background-color: #fff;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        input[type="text"] { padding: 12px; font-size: 20px; border-radius: 10px; border: 3px solid #ffca28; width: 60%; font-family: 'Jua', sans-serif; text-align: center; margin-bottom: 20px; }
        
        .btn { padding: 10px 5px; margin: 5px; font-size: 18px; cursor: pointer; border: none; border-radius: 12px; color: white; transition: all 0.2s; font-family: 'Jua', sans-serif; box-shadow: 0 4px 0px rgba(0,0,0,0.1); }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        .start-btn { background: #ff7043; width: 80%; font-size: 28px; margin-top: 20px; padding: 15px; border-bottom: 5px solid #d84315; }
        
        .select-group { margin: 20px 0; border-bottom: 2px dashed #eee; padding-bottom: 20px; }
        .group-title { font-size: 20px; color: #555; margin-bottom: 10px; font-weight: bold;}
        
        .btn-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .lvl-btn, .diff-btn { 
            width: 100px; height: 60px; 
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; line-height: 1.2;
        }
        .lvl-btn { background: #e0e0e0; color: #555; }
        .lvl-btn.active { background: #29b6f6; color: white; box-shadow: 0 0 0 3px #0288d1 inset; transform: scale(1.05); }
        .diff-btn { background: #ffe082; color: #5d4037; font-size: 15px; }
        .diff-btn.active { background: #ffca28; color: black; box-shadow: 0 0 0 3px #f57f17 inset; transform: scale(1.05); }

        .game-header { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 22px; color: #d84315; font-weight: bold; align-items: center; }
        
        .game-board { 
            display: grid; 
            gap: 20px; 
            row-gap: 20px;
            margin: 0 auto; 
            perspective: 1000px; 
            justify-content: center;
            padding: 10px;
        }

        .card { 
            background-color: transparent; 
            width: 100%; 
            aspect-ratio: 1 / 1; 
            cursor: pointer; position: relative; transform-style: preserve-3d; transition: transform 0.4s; 
            min-width: 90px; 
        }
        .card.flip { transform: rotateY(180deg); }
        
        .card.matched { pointer-events: none; }
        .card.matched .back {
            border-color: #66bb6a;     
            background-color: #e8f5e9; 
            color: #2e7d32;            
            box-shadow: 0 0 15px #a5d6a7; 
            transform: rotateY(180deg) scale(1.05);
        }

        .face { width: 100%; height: 100%; position: absolute; backface-visibility: hidden; border-radius: 15px; display: flex; justify-content: center; align-items: center; box-shadow: 0 5px 10px rgba(0,0,0,0.15); font-weight: bold; padding: 5px; word-break: keep-all; overflow: hidden; }
        
        .front { background: #29b6f6; color: white; font-size: 60px; transform: rotateY(0deg); border: 4px solid #0288d1; }
        
        .back { 
            background: white; 
            color: #000; 
            transform: rotateY(180deg); border: 4px solid #29b6f6; 
            font-size: 32px; 
            font-weight: bold; 
            display: flex; align-items: center; justify-content: center; text-align: center; 
            line-height: 1.25; 
            overflow-y: auto; 
            padding: 4px;
        }
        .back::-webkit-scrollbar { display: none; }
        .back.is-word { color: #0277bd; font-weight: 900; } 
        .card.matched .back.is-word { color: #1b5e20; }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 16px; }
        th, td { padding: 8px; border-bottom: 1px solid #eee; text-align: center; }
        th { background: #fff3e0; color: #555; }
        .rank-1 { color: #ff6f00; font-size: 1.3em; text-shadow: 1px 1px 0 #ffe0b2; }
        
        @media (max-width: 600px) {
            .game-board { gap: 10px; row-gap: 10px; }
            .lvl-btn, .diff-btn { width: 45%; margin: 5px 2px; height: 55px;}
            input[type="text"] { width: 80%; }
            .front { font-size: 40px; }
            .back { font-size: 20px; border-width: 3px; padding: 2px;}
            .back.is-word { font-size: 28px; }
            h1 { font-size: 28px; }
            .char-img { width: 120px; height: 120px; } /* ëª¨ë°”ì¼ì—ì„œ ì´ë¯¸ì§€ ì¡°ê¸ˆ ì‘ê²Œ */
        }
    </style>
</head>
<body>

    <div id="intro-screen" class="game-box">
        <div class="character-area">
            <img src="dog.png" alt="ê°œìŠˆíƒ€ì¸ ë°•ì‚¬ë‹˜" class="char-img" onerror="this.src='https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Dog%20Face.png'">
            </div>
        <h1>ê°œìŠˆíƒ€ì¸ ë°•ì‚¬ë‹˜ì˜<br>ì–´íœ˜ ì™ì™!</h1>
        <p style="color:#777; margin-bottom: 20px;">ë‹¨ì–´ì˜ ì§ê¿ì„ ì°¾ì•„ë³´ì„¸ìš”!</p>

        <input type="text" id="username" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="8">
        
        <div class="select-group">
            <div class="group-title">ğŸ“š í•™ë…„ ì„ íƒ</div>
            <div class="btn-container">
                <button class="btn lvl-btn active" onclick="selectLevel('1-2', this)">1-2í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('3-4', this)">3-4í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('5-6', this)">5-6í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('ì¤‘1', this)">ì¤‘1</button>
            </div>
        </div>

        <div class="select-group">
            <div class="group-title">ğŸ”¥ ë‚œì´ë„ ì„ íƒ</div>
            <div class="btn-container">
                <button class="btn diff-btn active" onclick="selectDifficulty(8, this)">ğŸŒ± ì‰¬ì›€<br>(8ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(16, this)">ğŸ¥ ë³´í†µ<br>(16ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(24, this)">ğŸ¦… ì–´ë ¤ì›€<br>(24ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(40, this)">ğŸ”¥ ì§€ì˜¥<br>(40ì¥)</button>
            </div>
        </div>

        <button class="btn start-btn" onclick="startGame()">ê²Œì„ ì‹œì‘ â–¶</button>
        
        <div style="margin-top: 30px;">
            <h3>ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹</h3>
            <table id="ranking-table"><tr><td>ê¸°ë¡ ë¡œë”©ì¤‘...</td></tr></table>
        </div>
    </div>

    <div id="game-screen" class="game-box hidden">
        <div class="game-header">
            <span style="font-size:30px;">ğŸ¶</span> 
            <span id="player-display">í”Œë ˆì´ì–´: ???</span>
            <span id="timer-display">ì‹œê°„: 0.0ì´ˆ</span>
        </div>
        <div class="game-board" id="board"></div>
    </div>

    <div id="result-screen" class="game-box hidden">
        <div class="character-area">
             <img src="dog.png" alt="ê°œìŠˆíƒ€ì¸ ë°•ì‚¬ë‹˜" class="char-img" onerror="this.src='https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Dog%20Face.png'">
        </div>
        <h1 style="color:#2e7d32">ì°¸ ì˜í–ˆì–´ìš”!</h1>
        <h2 id="final-record" style="color: #d84315; font-size: 40px; margin: 10px 0;">ê¸°ë¡: 0.0ì´ˆ</h2>
        <p>ê°œìŠˆíƒ€ì¸ ë°•ì‚¬ë‹˜ì´ ì¹­ì°¬í•©ë‹ˆë‹¤! ì™ˆì™ˆ!</p>
        <button class="btn start-btn" style="background:#66bb6a; border-bottom: 5px solid #2e7d32;" onclick="location.reload()">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <script src="my_word_data.js"></script> 
    <script>
        if (typeof wordData === 'undefined') {
            var wordData = { "1-2": [], "3-4": [], "5-6": [], "ì¤‘1": [] };
            for(let i=0; i<20; i++) wordData["1-2"].push({word: "í…ŒìŠ¤íŠ¸"+i, mean: "í…ŒìŠ¤íŠ¸ëœ»"+i});
            wordData["3-4"] = wordData["5-6"] = wordData["ì¤‘1"] = wordData["1-2"];
        }

        let currentLevel = "1-2";
        let currentCardCount = 8;
        let userName = "";
        let startTime;
        let timerInterval;
        let cardsArray = [];
        let matchedPairs = 0;
        let hasFlippedCard = false;
        let lockBoard = false;
        let firstCard, secondCard;

        window.onload = loadRanking;

        function selectLevel(lvl, btn) {
            currentLevel = lvl;
            document.querySelectorAll('.lvl-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function selectDifficulty(count, btn) {
            currentCardCount = count;
            document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function startGame() {
            const inputName = document.getElementById('username').value.trim();
            if (!inputName) { alert("ì´ë¦„ì„ ì…ë ¥í•´ì•¼ ë°•ì‚¬ë‹˜ì´ ë“¤ì—¬ë³´ë‚´ ì¤˜ìš”!"); return; }
            userName = inputName;
            document.getElementById('player-display').innerText = `${userName} í•™ìƒ`;

            if (!wordData[currentLevel] || wordData[currentLevel].length < currentCardCount / 2) {
                alert(`âš ï¸ ë°ì´í„° ë¶€ì¡±!\n'${currentLevel}'ì˜ ë‹¨ì–´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ë‚œì´ë„ë¥¼ ë‚®ì¶°ì£¼ì„¸ìš”.`);
                return;
            }

            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            resetBoard();
            setupBoard();
        }

        function setupBoard() {
            const data = wordData[currentLevel];
            const pairCount = currentCardCount / 2;
            const gameData = data.sort(() => 0.5 - Math.random()).slice(0, pairCount);

            cardsArray = [];
            gameData.forEach(item => {
                cardsArray.push({ text: item.word, type: 'word', pairId: item.word, cssClass: 'is-word' });
                cardsArray.push({ text: item.mean, type: 'mean', pairId: item.word, cssClass: '' });
            });
            cardsArray.sort(() => 0.5 - Math.random());

            const board = document.getElementById('board');
            board.innerHTML = '';

            let columns = 4;
            if (currentCardCount === 8) columns = 4;
            else if (currentCardCount === 16) columns = 4;
            else if (currentCardCount === 24) columns = 5; 
            else if (currentCardCount === 40) columns = 6;
            
            if (window.innerWidth < 600) {
                if (currentCardCount >= 24) columns = 4;
                else columns = 3; 
            }

            board.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

            cardsArray.forEach(card => {
                const el = document.createElement('div');
                el.classList.add('card');
                el.dataset.pairId = card.pairId;
                
                let fontSize = '34px'; 
                if(card.type === 'mean') {
                    if(card.text.length > 40) fontSize = '24px';      
                    else if(card.text.length > 30) fontSize = '28px'; 
                    else if(card.text.length > 20) fontSize = '32px'; 
                    else if(card.text.length > 10) fontSize = '38px'; 
                    else fontSize = '45px';                           
                } else {
                    if(card.text.length > 5) fontSize = '42px';       
                    else fontSize = '65px';                           
                }

                el.innerHTML = `
                    <div class="face front">?</div>
                    <div class="face back ${card.cssClass}" style="font-size:${fontSize}">${card.text}</div>
                `;
                el.addEventListener('click', flipCard);
                board.appendChild(el);
            });

            matchedPairs = 0;
            startTime = Date.now();
            if(timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 100);
        }

        function updateTimer() {
            const time = ((Date.now() - startTime) / 1000).toFixed(1);
            document.getElementById('timer-display').innerText = `${time}ì´ˆ`;
        }

        function flipCard() {
            if (lockBoard) return;
            if (this === firstCard) return;
            this.classList.add('flip');
            if (!hasFlippedCard) { hasFlippedCard = true; firstCard = this; return; }
            secondCard = this;
            checkForMatch();
        }

        function checkForMatch() {
            let isMatch = firstCard.dataset.pairId === secondCard.dataset.pairId;
            isMatch ? disableCards() : unflipCards();
        }

        function disableCards() {
            firstCard.removeEventListener('click', flipCard);
            secondCard.removeEventListener('click', flipCard);

            firstCard.classList.add('matched');
            secondCard.classList.add('matched');

            matchedPairs++;
            resetBoard();

            if (matchedPairs === cardsArray.length / 2) {
                clearInterval(timerInterval);
                setTimeout(() => {
                    endGame(((Date.now() - startTime) / 1000).toFixed(1));
                }, 2000); 
            }
        }

        function unflipCards() {
            lockBoard = true;
            setTimeout(() => {
                firstCard.classList.remove('flip');
                secondCard.classList.remove('flip');
                resetBoard();
            }, 1500); 
        }

        function resetBoard() {
            [hasFlippedCard, lockBoard] = [false, false];
            [firstCard, secondCard] = [null, null];
        }

        function endGame(time) {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('final-record').innerText = `ê¸°ë¡: ${time}ì´ˆ`;
            const rankKey = `${currentLevel} (${currentCardCount}ì¥)`;
            saveScore(userName, parseFloat(time), rankKey);
        }

        function saveScore(name, time, mode) {
            let records = JSON.parse(localStorage.getItem('vocabGameRank')) || [];
            records.push({ name: name, time: time, mode: mode, date: new Date().toLocaleDateString() });
            records.sort((a, b) => a.time - b.time);
            localStorage.setItem('vocabGameRank', JSON.stringify(records));
        }

        function loadRanking() {
            const table = document.getElementById('ranking-table');
            let records = JSON.parse(localStorage.getItem('vocabGameRank')) || [];
            let html = `<tr><th>ìˆœìœ„</th><th>ì´ë¦„</th><th>ëª¨ë“œ</th><th>ê¸°ë¡</th></tr>`;
            records.slice(0, 5).forEach((r, index) => {
                let badge = index === 0 ? 'ğŸ¥‡' : (index === 1 ? 'ğŸ¥ˆ' : (index === 2 ? 'ğŸ¥‰' : index + 1));
                let rankClass = index < 3 ? `rank-${index+1}` : '';
                html += `<tr><td class="${rankClass}"><b>${badge}</b></td><td>${r.name}</td><td><small>${r.mode}</small></td><td>${r.time}ì´ˆ</td></tr>`;
            });
            if (records.length === 0) html += `<tr><td colspan="4">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ë„ì „í•˜ì„¸ìš”!</td></tr>`;
            table.innerHTML = html;
        }
    </script>
</body>
</html>