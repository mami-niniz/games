<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–´íœ˜ë ¥ ì‘¥ì‘¥! ì¹´ë“œ ë’¤ì§‘ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Jua', sans-serif; background: #e3f2fd; text-align: center; margin: 0; padding: 20px; }
        .game-box { background: white; border-radius: 20px; padding: 30px; max-width: 1200px; margin: 0 auto; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .hidden { display: none !important; }
        h1 { color: #1565c0; margin-bottom: 20px; word-break: keep-all;}
        
        input[type="text"] { padding: 12px; font-size: 20px; border-radius: 10px; border: 2px solid #90caf9; width: 60%; font-family: 'Jua', sans-serif; text-align: center; margin-bottom: 20px; }
        
        .btn { padding: 10px 5px; margin: 5px; font-size: 18px; cursor: pointer; border: none; border-radius: 12px; color: white; transition: all 0.2s; font-family: 'Jua', sans-serif; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .btn:hover { transform: scale(1.03); filter: brightness(1.1); }
        .start-btn { background: #42a5f5; width: 80%; font-size: 24px; margin-top: 20px; padding: 15px; }
        
        .select-group { margin: 20px 0; border-bottom: 2px dashed #eee; padding-bottom: 20px; }
        .group-title { font-size: 18px; color: #555; margin-bottom: 10px; font-weight: bold;}
        
        .btn-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
        .lvl-btn, .diff-btn { 
            width: 100px; height: 60px; 
            display: flex; align-items: center; justify-content: center;
            font-size: 16px; line-height: 1.2;
        }
        .lvl-btn { background: #e0e0e0; color: #555; }
        .lvl-btn.active { background: #1e88e5; color: white; box-shadow: 0 4px 10px rgba(30, 136, 229, 0.4); transform: scale(1.05); border: 2px solid #1565c0; }
        .diff-btn { background: #ffe082; color: #5d4037; font-size: 15px; }
        .diff-btn.active { background: #ffca28; color: black; box-shadow: 0 4px 10px rgba(255, 202, 40, 0.4); transform: scale(1.05); border: 2px solid orange; }

        .game-header { display: flex; justify-content: space-between; margin-bottom: 15px; font-size: 20px; color: #1565c0; font-weight: bold; }
        
        .game-board { 
            display: grid; 
            gap: 20px; 
            row-gap: 20px;
            margin: 0 auto; 
            perspective: 1000px; 
            justify-content: center;
            padding: 10px;
        }

        .card { 
            background-color: transparent; 
            width: 100%; 
            aspect-ratio: 1 / 1; 
            cursor: pointer; position: relative; transform-style: preserve-3d; transition: transform 0.4s; 
            min-width: 90px; 
        }
        .card.flip { transform: rotateY(180deg); }
        .card.matched { visibility: hidden; opacity: 0; transition: opacity 0.3s; }

        .face { width: 100%; height: 100%; position: absolute; backface-visibility: hidden; border-radius: 15px; display: flex; justify-content: center; align-items: center; box-shadow: 0 5px 10px rgba(0,0,0,0.15); font-weight: bold; padding: 5px; word-break: keep-all; overflow: hidden; }
        
        .front { background: #2196f3; color: white; font-size: 60px; transform: rotateY(0deg); }
        
        /* â˜… ì¹´ë“œ ë’·ë©´(ëœ») ìŠ¤íƒ€ì¼ ê°œì„  */
        .back { 
            background: white; 
            color: black; /* ê¸€ììƒ‰ ì™„ì „ ê²€ì •ìœ¼ë¡œ ë³€ê²½ */
            transform: rotateY(180deg); border: 4px solid #2196f3; 
            font-size: 28px; /* ê¸°ë³¸ í¬ê¸° ëŒ€í­ í™•ëŒ€ (24 -> 28) */
            display: flex; align-items: center; justify-content: center; text-align: center; 
            line-height: 1.4; /* ì¤„ê°„ê²© ë„“í˜ */
            overflow-y: auto; 
            padding: 8px; /* ì•ˆìª½ ì—¬ë°± í™•ë³´ */
        }
        .back::-webkit-scrollbar { display: none; }

        /* ë‹¨ì–´ëŠ” ë” ì§„í•˜ê³  í¬ê²Œ */
        .back.is-word { color: #1565c0; font-weight: 900; } 

        table { width: 100%; border-collapse: collapse; margin-top: 10px; font-size: 16px; }
        th, td { padding: 8px; border-bottom: 1px solid #eee; text-align: center; }
        th { background: #f5f5f5; color: #555; }
        .rank-1 { color: gold; font-size: 1.3em; text-shadow: 1px 1px 0 #aaa; }
        
        @media (max-width: 600px) {
            .game-board { gap: 10px; row-gap: 10px; }
            .lvl-btn, .diff-btn { width: 45%; margin: 5px 2px; height: 55px;}
            input[type="text"] { width: 80%; }
            .front { font-size: 40px; }
            .back { font-size: 18px; border-width: 3px; padding: 4px;}
            .back.is-word { font-size: 24px; }
        }
    </style>
</head>
<body>

    <div id="intro-screen" class="game-box">
        <h1>ğŸ§  ì–´íœ˜ë ¥ ì¹´ë“œ ë’¤ì§‘ê¸°</h1>
        <input type="text" id="username" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="8">
        
        <div class="select-group">
            <div class="group-title">ğŸ“š í•™ë…„ ì„ íƒ</div>
            <div class="btn-container">
                <button class="btn lvl-btn active" onclick="selectLevel('1-2', this)">1-2í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('3-4', this)">3-4í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('5-6', this)">5-6í•™ë…„</button>
                <button class="btn lvl-btn" onclick="selectLevel('ì¤‘1', this)">ì¤‘1</button>
            </div>
        </div>

        <div class="select-group">
            <div class="group-title">ğŸ”¥ ë‚œì´ë„(ê°œìˆ˜) ì„ íƒ</div>
            <div class="btn-container">
                <button class="btn diff-btn active" onclick="selectDifficulty(8, this)">ğŸŒ± ì‰¬ì›€<br>(8ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(16, this)">ğŸ¥ ë³´í†µ<br>(16ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(24, this)">ğŸ¦… ì–´ë ¤ì›€<br>(24ì¥)</button>
                <button class="btn diff-btn" onclick="selectDifficulty(40, this)">ğŸ”¥ ì§€ì˜¥<br>(40ì¥)</button>
            </div>
        </div>

        <button class="btn start-btn" onclick="startGame()">ê²Œì„ ì‹œì‘ â–¶</button>
        
        <div style="margin-top: 20px;">
            <h3>ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹ (TOP 5)</h3>
            <table id="ranking-table"><tr><td>ê¸°ë¡ ë¡œë”©ì¤‘...</td></tr></table>
        </div>
    </div>

    <div id="game-screen" class="game-box hidden">
        <div class="game-header">
            <span id="player-display">í”Œë ˆì´ì–´: ???</span>
            <span id="timer-display">ì‹œê°„: 0.0ì´ˆ</span>
        </div>
        <div class="game-board" id="board"></div>
    </div>

    <div id="result-screen" class="game-box hidden">
        <h1>ğŸ‰ ê²Œì„ ì„±ê³µ!</h1>
        <h2 id="final-record" style="color: #d32f2f; font-size: 40px;">ê¸°ë¡: 0.0ì´ˆ</h2>
        <p>ì°¸ ì˜í–ˆì–´ìš”! ìˆœìœ„ì— ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
        <button class="btn start-btn" style="background:#66bb6a" onclick="location.reload()">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <script src="my_word_data.js"></script> 
    <script>
        if (typeof wordData === 'undefined') {
            var wordData = { "1-2": [], "3-4": [], "5-6": [], "ì¤‘1": [] };
            for(let i=0; i<20; i++) wordData["1-2"].push({word: "í…ŒìŠ¤íŠ¸"+i, mean: "í…ŒìŠ¤íŠ¸ëœ»"+i});
            wordData["3-4"] = wordData["5-6"] = wordData["ì¤‘1"] = wordData["1-2"];
        }

        let currentLevel = "1-2";
        let currentCardCount = 8;
        let userName = "";
        let startTime;
        let timerInterval;
        let cardsArray = [];
        let matchedPairs = 0;
        let hasFlippedCard = false;
        let lockBoard = false;
        let firstCard, secondCard;

        window.onload = loadRanking;

        function selectLevel(lvl, btn) {
            currentLevel = lvl;
            document.querySelectorAll('.lvl-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function selectDifficulty(count, btn) {
            currentCardCount = count;
            document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function startGame() {
            const inputName = document.getElementById('username').value.trim();
            if (!inputName) { alert("ì´ë¦„ì„ ê¼­ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }
            userName = inputName;
            document.getElementById('player-display').innerText = `í”Œë ˆì´ì–´: ${userName} (${currentLevel})`;

            if (!wordData[currentLevel] || wordData[currentLevel].length < currentCardCount / 2) {
                alert(`âš ï¸ ë°ì´í„° ë¶€ì¡±!\n'${currentLevel}'ì˜ ë‹¨ì–´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. ë‚œì´ë„ë¥¼ ë‚®ì¶°ì£¼ì„¸ìš”.`);
                return;
            }

            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            setupBoard();
        }

        function setupBoard() {
            const data = wordData[currentLevel];
            const pairCount = currentCardCount / 2;
            const gameData = data.sort(() => 0.5 - Math.random()).slice(0, pairCount);

            cardsArray = [];
            gameData.forEach(item => {
                cardsArray.push({ text: item.word, type: 'word', pairId: item.word, cssClass: 'is-word' });
                cardsArray.push({ text: item.mean, type: 'mean', pairId: item.word, cssClass: '' });
            });
            cardsArray.sort(() => 0.5 - Math.random());

            const board = document.getElementById('board');
            board.innerHTML = '';

            let columns = 4;
            if (currentCardCount === 8) columns = 4;
            else if (currentCardCount === 16) columns = 4;
            else if (currentCardCount === 24) columns = 5; 
            else if (currentCardCount === 40) columns = 6;
            
            if (window.innerWidth < 600) {
                if (currentCardCount >= 24) columns = 4;
                else columns = 3; 
            }

            board.style.gridTemplateColumns = `repeat(${columns}, 1fr)`;

            cardsArray.forEach(card => {
                const el = document.createElement('div');
                el.classList.add('card');
                el.dataset.pairId = card.pairId;
                
                // â˜… ê¸€ì í¬ê¸° ë¡œì§ ìˆ˜ì • (ë” í¬ê²Œ!)
                let fontSize = '28px'; // ê¸°ë³¸ê°’ (ê¸°ì¡´ 22px -> 28px)
                
                if(card.type === 'mean') {
                    // ëœ»ì¼ ë•Œ
                    if(card.text.length > 40) fontSize = '20px';      // ì•„ì£¼ ê¸´ ë¬¸ì¥
                    else if(card.text.length > 30) fontSize = '24px'; // ê¸´ ë¬¸ì¥
                    else if(card.text.length > 20) fontSize = '26px'; // ì¤‘ê°„ ë¬¸ì¥
                    else if(card.text.length > 10) fontSize = '30px'; // ì§§ì€ ë¬¸ì¥
                    else fontSize = '36px';                           // ì•„ì£¼ ì§§ì€ ëœ»
                } else {
                    // ë‹¨ì–´ì¼ ë•Œ
                    if(card.text.length > 5) fontSize = '40px';       
                    else fontSize = '60px';                           
                }

                el.innerHTML = `
                    <div class="face front">?</div>
                    <div class="face back ${card.cssClass}" style="font-size:${fontSize}">${card.text}</div>
                `;
                el.addEventListener('click', flipCard);
                board.appendChild(el);
            });

            matchedPairs = 0;
            startTime = Date.now();
            if(timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(updateTimer, 100);
        }

        function updateTimer() {
            const time = ((Date.now() - startTime) / 1000).toFixed(1);
            document.getElementById('timer-display').innerText = `ì‹œê°„: ${time}ì´ˆ`;
        }

        function flipCard() {
            if (lockBoard) return;
            if (this === firstCard) return;
            this.classList.add('flip');
            if (!hasFlippedCard) { hasFlippedCard = true; firstCard = this; return; }
            secondCard = this;
            checkForMatch();
        }

        function checkForMatch() {
            let isMatch = firstCard.dataset.pairId === secondCard.dataset.pairId;
            isMatch ? disableCards() : unflipCards();
        }

        function disableCards() {
            firstCard.removeEventListener('click', flipCard);
            secondCard.removeEventListener('click', flipCard);
            resetBoard();
            matchedPairs++;
            if (matchedPairs === cardsArray.length / 2) {
                clearInterval(timerInterval);
                endGame(((Date.now() - startTime) / 1000).toFixed(1));
            }
        }

        function unflipCards() {
            lockBoard = true;
            setTimeout(() => {
                firstCard.classList.remove('flip');
                secondCard.classList.remove('flip');
                resetBoard();
            }, 1500); 
        }

        function resetBoard() {
            [hasFlippedCard, lockBoard] = [false, false];
            [firstCard, secondCard] = [null, null];
        }

        function endGame(time) {
            setTimeout(() => {
                document.getElementById('game-screen').classList.add('hidden');
                document.getElementById('result-screen').classList.remove('hidden');
                document.getElementById('final-record').innerText = `ê¸°ë¡: ${time}ì´ˆ`;
                const rankKey = `${currentLevel} (${currentCardCount}ì¥)`;
                saveScore(userName, parseFloat(time), rankKey);
            }, 500);
        }

        function saveScore(name, time, mode) {
            let records = JSON.parse(localStorage.getItem('vocabGameRank')) || [];
            records.push({ name: name, time: time, mode: mode, date: new Date().toLocaleDateString() });
            records.sort((a, b) => a.time - b.time);
            localStorage.setItem('vocabGameRank', JSON.stringify(records));
        }

        function loadRanking() {
            const table = document.getElementById('ranking-table');
            let records = JSON.parse(localStorage.getItem('vocabGameRank')) || [];
            let html = `<tr><th>ìˆœìœ„</th><th>ì´ë¦„</th><th>ëª¨ë“œ</th><th>ê¸°ë¡</th></tr>`;
            records.slice(0, 5).forEach((r, index) => {
                let badge = index === 0 ? 'ğŸ¥‡' : (index === 1 ? 'ğŸ¥ˆ' : (index === 2 ? 'ğŸ¥‰' : index + 1));
                let rankClass = index < 3 ? `rank-${index+1}` : '';
                html += `<tr><td class="${rankClass}"><b>${badge}</b></td><td>${r.name}</td><td><small>${r.mode}</small></td><td>${r.time}ì´ˆ</td></tr>`;
            });
            if (records.length === 0) html += `<tr><td colspan="4">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤. ë„ì „í•˜ì„¸ìš”!</td></tr>`;
            table.innerHTML = html;
        }
    </script>
</body>
</html>