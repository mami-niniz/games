<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dino Word Drop</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Fredoka:wght@600&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
            background: linear-gradient(to bottom, #87CEEB, #E0F7FA); /* í•˜ëŠ˜ ë°°ê²½ */
            font-family: 'Jua', sans-serif;
            touch-action: none; /* ëª¨ë°”ì¼ í„°ì¹˜ í™•ëŒ€ ë°©ì§€ */
            user-select: none;
            -webkit-user-select: none;
            width: 100vw;
            height: 100vh;
        }

        /* UI ìƒë‹¨ */
        .header-ui {
            position: absolute;
            top: 20px;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 30px;
            font-size: 28px;
            color: #5D4037;
            box-sizing: border-box;
            z-index: 10;
            text-shadow: 2px 2px 0px rgba(255,255,255,0.5);
        }

        /* í”Œë ˆì´ì–´ (ê³µë£¡) */
        #player {
            position: absolute;
            bottom: 20px; /* ë°”ë‹¥ì—ì„œ ì•½ê°„ ë„ì›€ */
            width: 120px; /* ê¼¬ë¦¬ íŒì •ì„ ìœ„í•´ ë„ˆë¹„ í™•ëŒ€ */
            height: 100px;
            font-size: 80px;
            text-align: center;
            line-height: 100px;
            left: 50%;
            transform: translateX(-50%); /* ì •í™•í•œ ì¤‘ì•™ ì •ë ¬ */
            z-index: 5;
            /* í…ŒìŠ¤íŠ¸ìš© í…Œë‘ë¦¬ (ì‹¤ì œ ì ìš©ì‹œì—” ì œê±°ë¨) */
            /* border: 1px solid red; */
        }

        /* ë–¨ì–´ì§€ëŠ” ë‹¨ì–´ */
        .falling-item {
            position: absolute;
            background-color: white;
            padding: 10px 20px;
            border-radius: 20px;
            border: 4px solid #FF9800;
            font-family: 'Fredoka', sans-serif;
            font-weight: bold;
            color: #333;
            font-size: 24px;
            box-shadow: 0 5px 0 rgba(0,0,0,0.1);
            white-space: nowrap;
            transform: translateX(-50%); /* ì•„ì´í…œë„ ì¤‘ì•™ ê¸°ì¤€ ì •ë ¬ */
            z-index: 4;
        }

        /* ë‚˜ìœ ë‹¨ì–´ (ë˜¥, ë¶ˆ ë“±) */
        .bad-item {
            border-color: #555;
            background-color: #eceff1;
            color: #555;
        }

        /* ì „ì²´ í™”ë©´ ë®ê°œ (ì‹œì‘, ê²Œì„ì˜¤ë²„) */
        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            text-align: center;
        }

        .title { font-size: 50px; color: #5D4037; margin-bottom: 20px; }
        .desc { font-size: 22px; color: #666; margin-bottom: 40px; line-height: 1.5; }

        .game-btn {
            background: #FF9800;
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 28px;
            border-radius: 50px;
            font-family: 'Jua', sans-serif;
            cursor: pointer;
            box-shadow: 0 8px 0 #E65100;
            transition: transform 0.1s;
        }
        .game-btn:active { transform: translateY(4px); box-shadow: 0 4px 0 #E65100; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="start-screen" class="overlay">
        <div class="title">ğŸ¦• ê³µë£¡ ì˜ë‹¨ì–´</div>
        <div style="font-size: 100px; margin-bottom: 20px;">ğŸ¦–</div>
        <div class="desc">
            í™”ë©´ <b>ì™¼ìª½</b>ì„ ëˆ„ë¥´ë©´ ì™¼ìª½ìœ¼ë¡œ,<br>
            <b>ì˜¤ë¥¸ìª½</b>ì„ ëˆ„ë¥´ë©´ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ê°€ìš”!<br>
            (ê°€ë§Œíˆ ìˆì–´ë„ ë‹¿ìœ¼ë©´ ë¨¹ì–´ì§‘ë‹ˆë‹¤)
        </div>
        <button class="game-btn" onclick="startGame()">ê²Œì„ ì‹œì‘ â–¶</button>
    </div>

    <div class="header-ui">
        <span>â¤ï¸ <span id="lives">3</span></span>
        <span>â­ <span id="score">0</span></span>
    </div>

    <div id="player">ğŸ¦–</div>

    <div id="game-over-screen" class="overlay hidden">
        <h1 style="font-size: 50px; color: #D32F2F; margin-bottom: 10px;">ê²Œì„ ì˜¤ë²„!</h1>
        <div style="font-size: 80px; margin: 20px;">ğŸ’€</div>
        <h2 style="font-size: 35px; color: #5D4037;">ì ìˆ˜: <span id="final-score">0</span>ì </h2>
        <button class="game-btn" onclick="startGame()">ğŸ”„ ë‹¤ì‹œ í•˜ê¸°</button>
    </div>

    <script>
        // === [1] ë°ì´í„° ì„¤ì • ===
        const words = [
            "Apple", "Banana", "Cat", "Dog", "Egg", "Fish", "Good", "Hat", "Ice", "Jam",
            "King", "Love", "Mom", "No", "Orange", "Pig", "Queen", "Red", "Sun", "Tree",
            "Up", "Van", "Water", "Box", "Yes", "Zoo", "Book", "Desk", "Pen", "Car",
            "Sky", "Blue", "Run", "Jump", "Happy", "Sad", "Big", "Small", "Hot", "Cold"
        ];
        const badItems = ["ğŸ’©", "ğŸ”¥", "ğŸ’£", "âš¡"];

        // === [2] ê²Œì„ ë³€ìˆ˜ ===
        let isPlaying = false;
        let score = 0;
        let lives = 3;
        let playerX = 50; // ìœ„ì¹˜ (%)
        let moveDirection = 0; // -1: ì¢Œ, 0: ì •ì§€, 1: ìš°
        const playerSpeed = 1.5; // ì´ë™ ì†ë„

        let gameInterval;
        let dropInterval;
        let items = [];
        let dropSpeed = 0.5; // ë‚™í•˜ ì†ë„

        // === [3] DOM ìš”ì†Œ ===
        const player = document.getElementById('player');
        const scoreEl = document.getElementById('score');
        const livesEl = document.getElementById('lives');

        // === [4] ì˜¤ë””ì˜¤ íš¨ê³¼ìŒ ===
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);

            if (type === 'eat') { // ë ë§ (ì •ë‹µ)
                osc.type = 'sine'; 
                osc.frequency.setValueAtTime(800, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);
                osc.start(); osc.stop(audioCtx.currentTime + 0.1);
            } else if (type === 'hit') { // í½ (ì˜¤ë‹µ)
                osc.type = 'sawtooth'; 
                osc.frequency.setValueAtTime(150, audioCtx.currentTime);
                gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
                osc.start(); osc.stop(audioCtx.currentTime + 0.3);
            }
        }

        // ============================================
        // â˜… [í•µì‹¬ 1] ëª¨ë°”ì¼ í„°ì¹˜ ìŠ¬ë¼ì´ë“œ (ë¶€ë“œëŸ¬ìš´ ì´ë™)
        // ============================================
        function handleTouch(e) {
            if (!isPlaying) return;
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€

            const touch = e.touches[0];
            const screenWidth = window.innerWidth;

            if (touch.clientX < screenWidth / 2) {
                moveDirection = -1; // ì™¼ìª½
                player.style.transform = "translateX(-50%) scaleX(-1)"; // ì¢Œìš° ë°˜ì „
            } else {
                moveDirection = 1;  // ì˜¤ë¥¸ìª½
                player.style.transform = "translateX(-50%) scaleX(1)";
            }
        }

        document.addEventListener('touchstart', handleTouch, { passive: false });
        document.addEventListener('touchmove', handleTouch, { passive: false });
        document.addEventListener('touchend', () => { moveDirection = 0; });

        // PC í‚¤ë³´ë“œ ì§€ì›
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') { moveDirection = -1; player.style.transform = "translateX(-50%) scaleX(-1)"; }
            if (e.key === 'ArrowRight') { moveDirection = 1; player.style.transform = "translateX(-50%) scaleX(1)"; }
        });
        document.addEventListener('keyup', () => { moveDirection = 0; });

        // ============================================
        // â˜… [í•µì‹¬ 2] ê²Œì„ ë¡œì§ (ì¶©ëŒ íŒì • ê°œì„ )
        // ============================================
        function startGame() {
            if (audioCtx.state === 'suspended') audioCtx.resume();

            isPlaying = true;
            score = 0;
            lives = 3;
            dropSpeed = 0.5;
            playerX = 50;
            moveDirection = 0;
            
            // ê¸°ì¡´ ì•„ì´í…œ ì‹¹ ì§€ìš°ê¸°
            items.forEach(item => item.el.remove());
            items = [];

            updateUI();
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-over-screen').classList.add('hidden');

            // ê²Œì„ ë£¨í”„ ì‹œì‘
            clearInterval(gameInterval);
            clearInterval(dropInterval);
            gameInterval = setInterval(gameLoop, 16); // 60fps
            dropInterval = setInterval(createItem, 1000);
        }

        function gameLoop() {
            if (!isPlaying) return;

            // 1. ê³µë£¡ ì´ë™
            if (moveDirection !== 0) {
                playerX += moveDirection * playerSpeed;
                if (playerX < 10) playerX = 10;
                if (playerX > 90) playerX = 90;
                player.style.left = playerX + '%';
            }

            // 2. ì•„ì´í…œ ì´ë™ ë° ì¶©ëŒ ì²´í¬ (â˜…ì—­ìˆœ ë°˜ë³µë¬¸ ì‚¬ìš©: ìŠ¤í‚µ ë°©ì§€â˜…)
            for (let i = items.length - 1; i >= 0; i--) {
                let item = items[i];
                item.y += item.speed;
                item.el.style.top = item.y + '%';

                // ë°”ë‹¥ì— ë‹¿ìœ¼ë©´ ì‚­ì œ
                if (item.y > 100) {
                    item.el.remove();
                    items.splice(i, 1);
                    continue;
                }

                // â˜… [í•µì‹¬ 3] ì¶©ëŒ ë²”ìœ„ ëŒ€í­ í™•ëŒ€ (ê°€ë§Œíˆ ìˆì–´ë„ ë§ê²Œ ìˆ˜ì •) â˜…
                // Yì¶•: 75% ~ 100% (ê³µë£¡ ë¨¸ë¦¬ ìœ„ë¶€í„° ë°”ë‹¥ê¹Œì§€ ë„‰ë„‰í•˜ê²Œ)
                // Xì¶•: ê±°ë¦¬ 22% ì´ë‚´ (ê¼¬ë¦¬ê¹Œì§€ ë„‰ë„‰í•˜ê²Œ ì»¤ë²„)
                if (item.y > 75 && item.y < 100) {
                    const itemX = parseFloat(item.el.style.left);
                    const dist = Math.abs(playerX - itemX);

                    if (dist < 22) { // íŒì • ë²”ìœ„ 22ë¡œ í™•ëŒ€
                        handleCollision(item, i);
                    }
                }
            }
        }

        function createItem() {
            if (!isPlaying) return;

            const el = document.createElement('div');
            el.classList.add('falling-item');
            
            const isBad = Math.random() < 0.2;
            let type = 'good';

            if (isBad) {
                el.innerText = badItems[Math.floor(Math.random() * badItems.length)];
                el.classList.add('bad-item');
                type = 'bad';
            } else {
                el.innerText = words[Math.floor(Math.random() * words.length)];
            }

            // ìœ„ì¹˜ ëœë¤ (ê°€ì¥ìë¦¬ ë„ˆë¬´ ë¶™ì§€ ì•Šê²Œ 10~90%)
            const startX = Math.random() * 80 + 10;
            el.style.left = startX + '%';
            el.style.top = '-10%';
            document.body.appendChild(el);

            items.push({
                el: el,
                y: -10,
                speed: dropSpeed + Math.random() * 0.3,
                type: type
            });
        }

        function handleCollision(item, index) {
            // ë§ìœ¼ë©´ ë°”ë¡œ ì‚­ì œ
            item.el.remove();
            items.splice(index, 1);

            if (item.type === 'good') {
                score += 10;
                playSound('eat');
                if (score % 50 === 0) dropSpeed += 0.1; // ë‚œì´ë„ ìƒìŠ¹
            } else {
                lives--;
                playSound('hit');
                player.innerText = "ğŸ˜µ";
                setTimeout(() => player.innerText = "ğŸ¦–", 500);
            }

            updateUI();

            if (lives <= 0) {
                endGame();
            }
        }

        function updateUI() {
            scoreEl.innerText = score;
            livesEl.innerText = lives;
        }

        function endGame() {
            isPlaying = false;
            clearInterval(gameInterval);
            clearInterval(dropInterval);
            document.getElementById('final-score').innerText = score;
            document.getElementById('game-over-screen').classList.remove('hidden');
        }
    </script>
</body>
</html>